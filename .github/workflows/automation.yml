name: í…”ë ˆê·¸ë¨ ìë™ ì•Œë¦¼

on:
  workflow_dispatch:
  schedule:
    - cron: '0 22 * * *'
    - cron: '0 */4 * * *'

jobs:
  telegram-alerts:
    runs-on: ubuntu-latest
    
    steps:
    - name: Send Test Message
      env:
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        CHAT_ID: ${{ secrets.CHAT_ID }}
      run: |
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=ğŸ¤– GitHub Actions ìë™í™” í…ŒìŠ¤íŠ¸

        âœ… ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!
        
        ğŸ“Š ì„¤ì •ëœ ê¸°ëŠ¥:
        â€¢ ë§¤ì¼ 07ì‹œ ê³µí¬íƒìš•ì§€ìˆ˜ ì•Œë¦¼
        â€¢ 4ì‹œê°„ë§ˆë‹¤ ì£¼ì‹ ì •ë³´
        â€¢ ìë™ ìŠ¤ì¼€ì¤„ë§ ì‹¤í–‰
        
        ğŸ• í˜„ì¬ ì‹œê°„: $(date '+%Y-%m-%d %H:%M KST')
        
        ğŸš€ ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ!"

    - name: Send Fear Greed Index
      env:
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        CHAT_ID: ${{ secrets.CHAT_ID }}
      run: |
        response=$(curl -s "https://api.alternative.me/fng/")
        value=$(echo "$response" | grep -o '"value":"[^"]*' | head -1 | cut -d'"' -f4)
        classification=$(echo "$response" | grep -o '"value_classification":"[^"]*' | head -1 | cut -d'"' -f4)
        
        if [ -z "$value" ]; then
          value="50"
          classification="Neutral"
        fi
        
        if [ "$value" -le 24 ]; then
          emoji="ğŸ˜±"
        elif [ "$value" -le 49 ]; then
          emoji="ğŸ˜°"
        elif [ "$value" -le 74 ]; then
          emoji="ğŸ¤‘"
        else
          emoji="ğŸ¤¯"
        fi
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=${emoji} ì˜¤ëŠ˜ì˜ ê³µí¬íƒìš•ì§€ìˆ˜

        í˜„ì¬ ì§€ìˆ˜: ${value}/100
        ìƒíƒœ: ${classification}
        
        ğŸ’¡ ì§€ìˆ˜ í•´ì„:
        0-24: ê·¹ë„ì˜ ê³µí¬ ğŸ˜±
        25-49: ê³µí¬ ğŸ˜°
        50-74: íƒìš• ğŸ¤‘
        75-100: ê·¹ë„ì˜ íƒìš• ğŸ¤¯
        
        ğŸ“… $(date '+%Y-%m-%d %H:%M KST')
        ğŸ“Š ë°ì´í„°: Alternative.me"

    - name: Send Stock Info
      env:
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        CHAT_ID: ${{ secrets.CHAT_ID }}
      run: |
        current_time=$(date '+%Y-%m-%d %H:%M KST')
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=ğŸ“± AAPL (Apple) ì£¼ì‹ ì •ë³´

        ğŸ’° ì‹¤ì‹œê°„ ì •ë³´ í™•ì¸:
        ğŸ“ˆ Yahoo Finance: https://finance.yahoo.com/quote/AAPL
        ğŸ“Š TradingView: https://www.tradingview.com/symbols/AAPL
        ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/AAPL/news
        
        ğŸ“… ${current_time}"
        
        sleep 3
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=ğŸš— TSLA (Tesla) ì£¼ì‹ ì •ë³´

        ğŸ’° ì‹¤ì‹œê°„ ì •ë³´ í™•ì¸:
        ğŸ“ˆ Yahoo Finance: https://finance.yahoo.com/quote/TSLA
        ğŸ“Š TradingView: https://www.tradingview.com/symbols/TSLA
        ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/TSLA/news
        
        ğŸ“… ${current_time}"
