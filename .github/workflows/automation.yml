name: Telegram Auto Alert

on:
  workflow_dispatch:
  schedule:
    - cron: '0 22 * * *'
    - cron: '0 */4 * * *'

jobs:
  send-telegram:
    runs-on: ubuntu-latest
    
    steps:
    - name: Send Test Message
      run: |
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ¤– GitHub Actions ìë™í™” í…ŒìŠ¤íŠ¸

        âœ… ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!
        
        ğŸ“Š ì„¤ì •ëœ ê¸°ëŠ¥:
        â€¢ ë§¤ì¼ 07ì‹œ ê³µí¬íƒìš•ì§€ìˆ˜ ì•Œë¦¼
        â€¢ 4ì‹œê°„ë§ˆë‹¤ ì£¼ì‹ ì •ë³´
        â€¢ ìë™ ìŠ¤ì¼€ì¤„ë§ ì‹¤í–‰
        
        ğŸ• í˜„ì¬ ì‹œê°„: $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M KST')
        
        ğŸš€ ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ!"

    - name: Send Fear Greed Index
      run: |
        response=$(curl -s "https://api.alternative.me/fng/")
        value=$(echo "$response" | grep -o '"value":"[^"]*' | head -1 | cut -d'"' -f4)
        classification=$(echo "$response" | grep -o '"value_classification":"[^"]*' | head -1 | cut -d'"' -f4)
        
        if [ -z "$value" ]; then
          value="50"
          classification="Neutral"
        fi
        
        # í•œê¸€ ìƒíƒœë¡œ ë³€í™˜
        case "$classification" in
          "Extreme Fear") korean_status="ê·¹ë„ì˜ ê³µí¬" ;;
          "Fear") korean_status="ê³µí¬" ;;
          "Neutral") korean_status="ì¤‘ë¦½" ;;
          "Greed") korean_status="íƒìš•" ;;
          "Extreme Greed") korean_status="ê·¹ë„ì˜ íƒìš•" ;;
          *) korean_status="$classification" ;;
        esac
        
        if [ "$value" -le 24 ]; then
          emoji="ğŸ˜±"
        elif [ "$value" -le 49 ]; then
          emoji="ğŸ˜°"
        elif [ "$value" -le 74 ]; then
          emoji="ğŸ¤‘"
        else
          emoji="ğŸ¤¯"
        fi
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=${emoji} ì˜¤ëŠ˜ì˜ ê³µí¬íƒìš•ì§€ìˆ˜

        í˜„ì¬ ì§€ìˆ˜: ${value}/100
        ìƒíƒœ: ${korean_status}
        
        ğŸ’¡ ì§€ìˆ˜ í•´ì„:
        0-24: ê·¹ë„ì˜ ê³µí¬ ğŸ˜± (ë§¤ìˆ˜ ê¸°íšŒ)
        25-49: ê³µí¬ ğŸ˜° (ì‹ ì¤‘í•œ ë§¤ìˆ˜)
        50-74: íƒìš• ğŸ¤‘ (ì‹ ì¤‘í•œ ë§¤ë„)  
        75-100: ê·¹ë„ì˜ íƒìš• ğŸ¤¯ (ë§¤ë„ ê³ ë ¤)
        
        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')
        ğŸ“Š ë°ì´í„° ì œê³µ: Alternative.me"

    - name: Send Apple Stock
      run: |
        sleep 2
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ“± AAPL (ì• í”Œ) ì£¼ì‹ ì •ë³´

        ğŸ’° ì‹¤ì‹œê°„ ë°ì´í„° í™•ì¸:
        ğŸ“ˆ ì•¼í›„ íŒŒì´ë‚¸ìŠ¤: https://finance.yahoo.com/quote/AAPL
        ğŸ“Š íŠ¸ë ˆì´ë”©ë·°: https://www.tradingview.com/symbols/AAPL
        ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/AAPL/news
        ğŸ” êµ¬ê¸€ ë‰´ìŠ¤: https://news.google.com/search?q=AAPL+Apple+stock
        
        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')"

    - name: Send Tesla Stock  
      run: |
        sleep 2
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸš— TSLA (í…ŒìŠ¬ë¼) ì£¼ì‹ ì •ë³´

        ğŸ’° ì‹¤ì‹œê°„ ë°ì´í„° í™•ì¸:
        ğŸ“ˆ ì•¼í›„ íŒŒì´ë‚¸ìŠ¤: https://finance.yahoo.com/quote/TSLA
        ğŸ“Š íŠ¸ë ˆì´ë”©ë·°: https://www.tradingview.com/symbols/TSLA
        ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/TSLA/news
        ğŸ” êµ¬ê¸€ ë‰´ìŠ¤: https://news.google.com/search?q=TSLA+Tesla+stock
        
        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')"

    - name: Send NVIDIA Stock
      run: |
        sleep 2
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ® NVDA (ì—”ë¹„ë””ì•„) ì£¼ì‹ ì •ë³´

        ğŸ’° ì‹¤ì‹œê°„ ë°ì´í„° í™•ì¸:
        ğŸ“ˆ ì•¼í›„ íŒŒì´ë‚¸ìŠ¤: https://finance.yahoo.com/quote/NVDA
        ğŸ“Š íŠ¸ë ˆì´ë”©ë·°: https://www.tradingview.com/symbols/NVDA
        ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/NVDA/news
        ğŸ” êµ¬ê¸€ ë‰´ìŠ¤: https://news.google.com/search?q=NVDA+NVIDIA+stock
        
        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')"

    - name: Send Market Summary
      run: |
        sleep 2
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ“Š ì‹œì¥ ìš”ì•½ ì •ë³´

        ğŸ”¥ ì£¼ìš” ì²´í¬ í¬ì¸íŠ¸:
        â€¢ ë¯¸êµ­ ì¦ì‹œ ë™í–¥ ë° ì§€ìˆ˜ í˜„í™©
        â€¢ ì—°ì¤€(Fed) ê¸ˆë¦¬ ì •ì±… ë‰´ìŠ¤
        â€¢ ì£¼ìš” ê¸°ì—… ì‹¤ì  ë°œí‘œ ì¼ì •
        â€¢ êµ­ì œ ê²½ì œ ì´ìŠˆ ë° ì˜í–¥

        ğŸ“ˆ ìœ ìš©í•œ ì‚¬ì´íŠ¸:
        ğŸŒ ì•¼í›„ íŒŒì´ë‚¸ìŠ¤: https://finance.yahoo.com
        ğŸ“º CNBC: https://www.cnbc.com/markets
        ğŸ“Š ë§ˆì¼“ì›Œì¹˜: https://www.marketwatch.com
        ğŸ“° CNN ë¹„ì¦ˆë‹ˆìŠ¤: https://edition.cnn.com/business
        
        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')
        
        â° ë‹¤ìŒ ì—…ë°ì´íŠ¸: 4ì‹œê°„ í›„"
