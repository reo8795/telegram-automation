name: Simple Link Only System

on:
  workflow_dispatch:
  schedule:
    - cron: '0 22 * * *'      # ë§¤ì¼ 07:00 KST (ê³µí¬íƒìš•ì§€ìˆ˜ ë§í¬)
    - cron: '0 */3 * * *'     # 3ì‹œê°„ë§ˆë‹¤ (ì¢…ëª© ë‰´ìŠ¤)

jobs:
  # ë§¤ì¼ ì•„ì¹¨ 7ì‹œ - ê³µí¬íƒìš•ì§€ìˆ˜ ë§í¬ë§Œ
  morning-fear-greed-link:
    runs-on: ubuntu-latest
    if: github.event.schedule == '0 22 * * *' || github.event_name == 'workflow_dispatch'
    
    steps:
    - name: Send CNN Fear Greed Link Only
      run: |
        echo "ê³µí¬íƒìš•ì§€ìˆ˜ ë§í¬ ì „ì†¡"
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ“Š ì˜¤ëŠ˜ì˜ ë¯¸êµ­ ì£¼ì‹ ê³µí¬íƒìš•ì§€ìˆ˜

        ğŸ”— CNN ê³µí¬íƒìš•ì§€ìˆ˜ í™•ì¸:
        https://www.cnn.com/markets/fear-and-greed

        ğŸ’¡ ê°„ë‹¨ ê°€ì´ë“œ:
        ğŸ˜± 0-24: ê·¹ë„ì˜ ê³µí¬ (ë§¤ìˆ˜ ê¸°íšŒ)
        ğŸ˜° 25-49: ê³µí¬ (ì‹ ì¤‘í•œ ë§¤ìˆ˜)
        ğŸ¤‘ 50-74: íƒìš• (ì‹ ì¤‘í•œ ë§¤ë„)
        ğŸ¤¯ 75-100: ê·¹ë„ì˜ íƒìš• (ë§¤ë„ ê³ ë ¤)

        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ 07:00 KST')

        âœ… ìœ„ ë§í¬ì—ì„œ ì •í™•í•œ ì§€ìˆ˜ì™€ ì°¨íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”"

  # 3ì‹œê°„ë§ˆë‹¤ - ì¢…ëª© ë‰´ìŠ¤ (ê¸°ì¡´ê³¼ ë™ì¼)
  korean-translated-news:
    runs-on: ubuntu-latest
    if: github.event.schedule == '0 */3 * * *' || github.event_name == 'workflow_dispatch'
    
    steps:
    - name: Get News and Translate to Korean
      run: |
        echo "ì¢…ëª© ë‰´ìŠ¤ í™•ì¸ ë° í•œêµ­ì–´ ë²ˆì—­ ì‹œì‘"
        
        # ì¢…ëª© ë¦¬ìŠ¤íŠ¸
        declare -A stocks=(
          ["CRCL"]="Circle Internet Group"
          ["OSCR"]="Oscar Health"
          ["ARQQ"]="Arqit Quantum"
          ["BTM"]="Bitcoin Depot"
          ["CRWV"]="CoreWeave"
          ["GLXY"]="Galaxy Digital"
          ["NBIS"]="Nebius Group"
          ["TSLA"]="Tesla"
          ["OKLO"]="Oklo"
          ["MRVL"]="Marvell Technology"
          ["PLTR"]="Palantir"
          ["AEVA"]="Aeva Technologies"
        )
        
        # í•œêµ­ì–´ ë²ˆì—­ í•¨ìˆ˜
        translate_to_korean() {
          local english_text="$1"
          korean_text="$english_text"
          
          # ê¸°ë³¸ ì£¼ì‹ ìš©ì–´
          korean_text=$(echo "$korean_text" | sed 's/\bstock\b/ì£¼ì‹/g')
          korean_text=$(echo "$korean_text" | sed 's/\bshares\b/ì£¼ì‹/g')
          korean_text=$(echo "$korean_text" | sed 's/\bearnings\b/ì‹¤ì /g')
          korean_text=$(echo "$korean_text" | sed 's/\brevenue\b/ë§¤ì¶œ/g')
          korean_text=$(echo "$korean_text" | sed 's/\bprofit\b/ì´ìµ/g')
          korean_text=$(echo "$korean_text" | sed 's/\bgains\b/ìƒìŠ¹/g')
          korean_text=$(echo "$korean_text" | sed 's/\bfalls\b/í•˜ë½/g')
          korean_text=$(echo "$korean_text" | sed 's/\brises\b/ìƒìŠ¹/g')
          korean_text=$(echo "$korean_text" | sed 's/\bdrops\b/í•˜ë½/g')
          korean_text=$(echo "$korean_text" | sed 's/\bsurges\b/ê¸‰ë“±/g')
          korean_text=$(echo "$korean_text" | sed 's/\bplunges\b/ê¸‰ë½/g')
          korean_text=$(echo "$korean_text" | sed 's/\binvestment\b/íˆ¬ì/g')
          korean_text=$(echo "$korean_text" | sed 's/\bmarket\b/ì‹œì¥/g')
          korean_text=$(echo "$korean_text" | sed 's/\bcompany\b/íšŒì‚¬/g')
          korean_text=$(echo "$korean_text" | sed 's/\bquarter\b/ë¶„ê¸°/g')
          korean_text=$(echo "$korean_text" | sed 's/\banalyst\b/ì• ë„ë¦¬ìŠ¤íŠ¸/g')
          korean_text=$(echo "$korean_text" | sed 's/\btarget\b/ëª©í‘œê°€/g')
          korean_text=$(echo "$korean_text" | sed 's/\bupgrade\b/ìƒí–¥ì¡°ì •/g')
          korean_text=$(echo "$korean_text" | sed 's/\bdowngrade\b/í•˜í–¥ì¡°ì •/g')
          korean_text=$(echo "$korean_text" | sed 's/\bbuy\b/ë§¤ìˆ˜/g')
          korean_text=$(echo "$korean_text" | sed 's/\bsell\b/ë§¤ë„/g')
          korean_text=$(echo "$korean_text" | sed 's/\bhold\b/ë³´ìœ /g')
          
          # íšŒì‚¬/ê¸°ìˆ  ìš©ì–´
          korean_text=$(echo "$korean_text" | sed 's/\bTesla\b/í…ŒìŠ¬ë¼/g')
          korean_text=$(echo "$korean_text" | sed 's/\bPalantir\b/íŒ”ë€í‹°ì–´/g')
          korean_text=$(echo "$korean_text" | sed 's/\bMarvell\b/ë§ˆë²¨/g')
          korean_text=$(echo "$korean_text" | sed 's/\belectric vehicle\b/ì „ê¸°ì°¨/g')
          korean_text=$(echo "$korean_text" | sed 's/\bEV\b/ì „ê¸°ì°¨/g')
          korean_text=$(echo "$korean_text" | sed 's/\bautonomous\b/ììœ¨ì£¼í–‰/g')
          korean_text=$(echo "$korean_text" | sed 's/\bAI\b/AI/g')
          korean_text=$(echo "$korean_text" | sed 's/\bartificial intelligence\b/ì¸ê³µì§€ëŠ¥/g')
          korean_text=$(echo "$korean_text" | sed 's/\bbitcoin\b/ë¹„íŠ¸ì½”ì¸/g')
          korean_text=$(echo "$korean_text" | sed 's/\bcryptocurrency\b/ì•”í˜¸í™”í/g')
          korean_text=$(echo "$korean_text" | sed 's/\bblockchain\b/ë¸”ë¡ì²´ì¸/g')
          korean_text=$(echo "$korean_text" | sed 's/\bquantum\b/ì–‘ì/g')
          korean_text=$(echo "$korean_text" | sed 's/\bcloud\b/í´ë¼ìš°ë“œ/g')
          korean_text=$(echo "$korean_text" | sed 's/\bsemiconductor\b/ë°˜ë„ì²´/g')
          korean_text=$(echo "$korean_text" | sed 's/\bchip\b/ì¹©/g')
          
          echo "$korean_text"
        }
        
        # ë„¤ì´ë²„ ë‰´ìŠ¤ í™•ì¸
        naver_news=$(curl -s "https://news.google.com/rss/search?q=NAVER+Korea+stock+ë„¤ì´ë²„" 2>/dev/null || echo "")
        if [ ! -z "$naver_news" ]; then
          naver_title=$(echo "$naver_news" | grep -o '<title><!\[CDATA\[.*\]\]></title>' | head -2 | tail -1 | sed 's/<title><!\[CDATA\[//g' | sed 's/\]\]><\/title>//g')
          
          if [ ! -z "$naver_title" ] && [ "$naver_title" != "" ] && [ "$naver_title" != "Google News" ]; then
            if echo "$naver_title" | grep -q '[ê°€-í£]'; then
              translated_title="$naver_title"
            else
              translated_title=$(translate_to_korean "$naver_title")
            fi
            
            curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
              -d "chat_id=${{ secrets.CHAT_ID }}" \
              -d "text=ğŸ‡°ğŸ‡· NAVER (035420) ìµœì‹  ë‰´ìŠ¤

            ğŸ“° ${translated_title}

            ğŸ”— ë‰´ìŠ¤ ë§í¬: https://news.google.com/search?q=NAVER+Korea
            ğŸ“Š ì£¼ê°€ í™•ì¸: https://finance.yahoo.com/quote/035420.KS

            ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')"
          fi
        fi
        
        # ë¯¸êµ­ ì¢…ëª©ë“¤ ë‰´ìŠ¤ í™•ì¸
        for symbol in "${!stocks[@]}"; do
          company_name="${stocks[$symbol]}"
          echo "ë‰´ìŠ¤ í™•ì¸: $symbol ($company_name)"
          
          news_data=$(curl -s "https://news.google.com/rss/search?q=${symbol}+${company_name// /+}+stock" 2>/dev/null || echo "")
          
          if [ ! -z "$news_data" ]; then
            english_title=$(echo "$news_data" | grep -o '<title><!\[CDATA\[.*\]\]></title>' | head -2 | tail -1 | sed 's/<title><!\[CDATA\[//g' | sed 's/\]\]><\/title>//g')
            
            if [ ! -z "$english_title" ] && [ "$english_title" != "" ] && [ "$english_title" != "Google News" ]; then
              korean_title=$(translate_to_korean "$english_title")
              news_link="https://news.google.com/search?q=${symbol}+stock"
              
              case "$symbol" in
                "TSLA") emoji="ğŸš—" ;;
                "PLTR") emoji="ğŸ”" ;;
                "MRVL") emoji="ğŸ’" ;;
                "BTM") emoji="â‚¿" ;;
                "GLXY") emoji="ğŸŒŒ" ;;
                "OSCR") emoji="ğŸ¥" ;;
                "OKLO") emoji="âš›ï¸" ;;
                "AEVA") emoji="ğŸ“¡" ;;
                "NBIS") emoji="ğŸ”¬" ;;
                "ARQQ") emoji="âš›ï¸" ;;
                "CRCL") emoji="ğŸŒ" ;;
                "CRWV") emoji="â˜ï¸" ;;
                *) emoji="ğŸ“ˆ" ;;
              esac
              
              curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
                -d "chat_id=${{ secrets.CHAT_ID }}" \
                -d "text=${emoji} ${symbol} (${company_name}) ìµœì‹  ë‰´ìŠ¤

              ğŸ“° ${korean_title}

              ğŸ”— ë‰´ìŠ¤ ë§í¬: ${news_link}
              ğŸ“Š ì£¼ê°€ í™•ì¸: https://finance.yahoo.com/quote/${symbol}

              ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')"
              
              sleep 3
            fi
          fi
          
          sleep 1
        done
        
        echo "ëª¨ë“  ë‰´ìŠ¤ í™•ì¸ ì™„ë£Œ"
