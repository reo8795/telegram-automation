name: í…”ë ˆê·¸ë¨ ìë™ ì•Œë¦¼

on:
  schedule:
    - cron: '0 22 * * *'
    - cron: '0 */4 * * *'
  workflow_dispatch:

env:
  TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
  CHAT_ID: ${{ secrets.CHAT_ID }}

jobs:
  send-all-messages:
    runs-on: ubuntu-latest
    
    steps:
    - name: ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€
      run: |
        echo "ì‹œì‘: í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡"
        
        MESSAGE="ğŸ¤– GitHub Actions ìë™í™” í…ŒìŠ¤íŠ¸

âœ… ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!

ğŸ“Š ì„¤ì •ëœ ê¸°ëŠ¥:
â€¢ ë§¤ì¼ 07ì‹œ ê³µí¬íƒìš•ì§€ìˆ˜ ì•Œë¦¼  
â€¢ 4ì‹œê°„ë§ˆë‹¤ ì£¼ì‹ ì •ë³´
â€¢ ìë™ ìŠ¤ì¼€ì¤„ë§ ì‹¤í–‰

ğŸ• í˜„ì¬ ì‹œê°„: $(date '+%Y-%m-%d %H:%M KST')

ğŸš€ ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™!"
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=${MESSAGE}"
        
        echo "ì™„ë£Œ: í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡"

    - name: ê³µí¬íƒìš•ì§€ìˆ˜ ì „ì†¡
      run: |
        echo "ì‹œì‘: ê³µí¬íƒìš•ì§€ìˆ˜ ìˆ˜ì§‘"
        
        RESPONSE=$(curl -s "https://api.alternative.me/fng/")
        VALUE=$(echo "$RESPONSE" | grep -o '"value":"[^"]*' | head -1 | cut -d'"' -f4)
        CLASS=$(echo "$RESPONSE" | grep -o '"value_classification":"[^"]*' | head -1 | cut -d'"' -f4)
        
        if [ -z "$VALUE" ]; then
          VALUE="50"
          CLASS="Neutral"
        fi
        
        if [ "$VALUE" -le 24 ]; then
          EMOJI="ğŸ˜±"
        elif [ "$VALUE" -le 49 ]; then
          EMOJI="ğŸ˜°"  
        elif [ "$VALUE" -le 74 ]; then
          EMOJI="ğŸ¤‘"
        else
          EMOJI="ğŸ¤¯"
        fi
        
        MESSAGE="${EMOJI} ì˜¤ëŠ˜ì˜ ê³µí¬íƒìš•ì§€ìˆ˜

í˜„ì¬ ì§€ìˆ˜: ${VALUE}/100
ìƒíƒœ: ${CLASS}

ğŸ’¡ ì§€ìˆ˜ í•´ì„:
0-24: ê·¹ë„ì˜ ê³µí¬ ğŸ˜±
25-49: ê³µí¬ ğŸ˜°
50-74: íƒìš• ğŸ¤‘  
75-100: ê·¹ë„ì˜ íƒìš• ğŸ¤¯

ğŸ“… $(date '+%Y-%m-%d %H:%M KST')
ğŸ“Š ë°ì´í„°: Alternative.me"
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=${MESSAGE}"
        
        echo "ì™„ë£Œ: ê³µí¬íƒìš•ì§€ìˆ˜ ì „ì†¡"

    - name: ì£¼ì‹ ì •ë³´ ì „ì†¡
      run: |
        echo "ì‹œì‘: ì£¼ì‹ ì •ë³´ ì „ì†¡"
        
        CURRENT_TIME=$(date '+%Y-%m-%d %H:%M KST')
        
        MESSAGE1="ğŸ“± AAPL (Apple) ì£¼ì‹ ì •ë³´

ğŸ’° ì‹¤ì‹œê°„ ì •ë³´ í™•ì¸:
ğŸ“ˆ Yahoo Finance: https://finance.yahoo.com/quote/AAPL
ğŸ“Š TradingView: https://www.tradingview.com/symbols/AAPL  
ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/AAPL/news

ğŸ“… ${CURRENT_TIME}"
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=${MESSAGE1}"
        
        sleep 2
        
        MESSAGE2="ğŸš— TSLA (Tesla) ì£¼ì‹ ì •ë³´

ğŸ’° ì‹¤ì‹œê°„ ì •ë³´ í™•ì¸:
ğŸ“ˆ Yahoo Finance: https://finance.yahoo.com/quote/TSLA
ğŸ“Š TradingView: https://www.tradingview.com/symbols/TSLA
ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/TSLA/news

ğŸ“… ${CURRENT_TIME}"
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=${MESSAGE2}"
        
        echo "ì™„ë£Œ: ì£¼ì‹ ì •ë³´ ì „ì†¡"
