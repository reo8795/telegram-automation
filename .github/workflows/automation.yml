name: Daily Stock Alerts

on:
  workflow_dispatch:
  schedule:
    - cron: '0 22 * * *'    # ë§¤ì¼ í•œêµ­ì‹œê°„ 07:00 (UTC 22:00)
    - cron: '30 8 * * *'    # ë§¤ì¼ í•œêµ­ì‹œê°„ 17:30 (UTC 08:30)

jobs:
  morning-fear-greed:
    runs-on: ubuntu-latest
    if: github.event.schedule == '0 22 * * *' || github.event_name == 'workflow_dispatch'
    
    steps:
    - name: Send Fear Greed Index
      run: |
        echo "ê³µí¬íƒìš•ì§€ìˆ˜ ì „ì†¡ ì‹œì‘"
        
        # CNN APIì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        cnn_data=$(curl -s "https://production.dataviz.cnn.io/index/fearandgreed/graphdata")
        
        if [ ! -z "$cnn_data" ] && echo "$cnn_data" | grep -q "fear_and_greed"; then
          fear_greed_score=$(echo "$cnn_data" | grep -o '"score":[0-9]*' | head -1 | cut -d':' -f2)
          fear_greed_rating=$(echo "$cnn_data" | grep -o '"rating":"[^"]*' | head -1 | cut -d'"' -f4)
          
          case "$fear_greed_rating" in
            "Extreme Fear") korean_rating="ê·¹ë„ì˜ ê³µí¬" ;;
            "Fear") korean_rating="ê³µí¬" ;;
            "Neutral") korean_rating="ì¤‘ë¦½" ;;
            "Greed") korean_rating="íƒìš•" ;;
            "Extreme Greed") korean_rating="ê·¹ë„ì˜ íƒìš•" ;;
            *) korean_rating="ì¤‘ë¦½" ;;
          esac
        else
          fear_greed_score="50"
          korean_rating="ì¤‘ë¦½"
        fi
        
        if [ "$fear_greed_score" -le 24 ]; then
          emoji="ğŸ˜±"
        elif [ "$fear_greed_score" -le 49 ]; then
          emoji="ğŸ˜°"
        elif [ "$fear_greed_score" -le 74 ]; then
          emoji="ğŸ¤‘"
        else
          emoji="ğŸ¤¯"
        fi
        
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=${emoji} ì˜¤ëŠ˜ì˜ ë¯¸êµ­ ì£¼ì‹ ê³µí¬íƒìš•ì§€ìˆ˜

        ğŸ“Š í˜„ì¬ ì§€ìˆ˜: ${fear_greed_score}/100 (${korean_rating})

        ğŸ’¡ ê°„ë‹¨ ê°€ì´ë“œ:
        ğŸ˜± 0-24: ê·¹ë„ì˜ ê³µí¬ (ë§¤ìˆ˜ ê¸°íšŒ)
        ğŸ˜° 25-49: ê³µí¬ (ì‹ ì¤‘í•œ ë§¤ìˆ˜)
        ğŸ¤‘ 50-74: íƒìš• (ì‹ ì¤‘í•œ ë§¤ë„)  
        ğŸ¤¯ 75-100: ê·¹ë„ì˜ íƒìš• (ë§¤ë„ ê³ ë ¤)

        ğŸ”— ìƒì„¸ ì°¨íŠ¸: https://www.cnn.com/markets/fear-and-greed

        ğŸ“… $(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')"

  evening-technical-analysis:
    runs-on: ubuntu-latest
    if: github.event.schedule == '30 8 * * *' || github.event_name == 'workflow_dispatch'
    
    steps:
    - name: Send Technical Analysis Summary
      run: |
        echo "ê¸°ìˆ ì  ë¶„ì„ ìš”ì•½ ì „ì†¡ ì‹œì‘"
        
        # í˜„ì¬ ì‹œê°„
        current_time=$(TZ='Asia/Seoul' date '+%Yë…„ %mì›” %dì¼ %H:%M KST')
        
        # ê¸°ìˆ ì  ë¶„ì„ ìš”ì•½ ë©”ì‹œì§€
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ“ˆ ì˜¤ëŠ˜ì˜ ì£¼ìš” ì¢…ëª© ê¸°ìˆ ì  ë¶„ì„

        ğŸ” ì§€ì§€/ì €í•­ ë° ê³¼ë§¤ë„/ê³¼ë§¤ìˆ˜ ë¶„ì„:

        ğŸŒ CRCL (ì¨í´ ì¸í„°ë„·): 
        â€¢ ì§€ì§€: ì‹¤ì‹œê°„ ì°¨íŠ¸ í™•ì¸ í•„ìš”
        â€¢ ì €í•­: TradingViewì—ì„œ í™•ì¸
        â€¢ RSI: ê³¼ë§¤ë„/ê³¼ë§¤ìˆ˜ ìƒíƒœ ì²´í¬

        ğŸ¥ OSCR (ì˜¤ìŠ¤ì¹´ í—¬ìŠ¤):
        â€¢ ì§€ì§€/ì €í•­: ì°¨íŠ¸ íŒ¨í„´ ë¶„ì„ í•„ìš”
        â€¢ ë³¼ë¦°ì € ë°´ë“œ: ë³€ë™ì„± í™•ì¸

        âš›ï¸ ARQQ (ì•„í‚· í€€í…€):
        â€¢ ê¸°ìˆ ì  ì§€í‘œ: ì†ŒëŸ‰ ê±°ë˜ë¡œ ì‹ ì¤‘ ì ‘ê·¼

        â‚¿ BTM (ë¹„íŠ¸ì½”ì¸ ë””í¬):
        â€¢ ë¹„íŠ¸ì½”ì¸ ì—°ë™ì„±: BTC ì°¨íŠ¸ í•¨ê»˜ ë¶„ì„

        ğŸŒ CRWV (ì½”ì–´ìœ„ë¸Œ):
        â€¢ í´ë¼ìš°ë“œ ì„¹í„° ëª¨ë©˜í…€ í™•ì¸

        ğŸ‡°ğŸ‡· NAVER (035420):
        â€¢ í•œêµ­ ì‹œì¥ ì§€ì§€/ì €í•­ì„  ë¶„ì„

        ğŸŒŒ GLXY (ê°¤ëŸ­ì‹œ ë””ì§€í„¸):
        â€¢ ì•”í˜¸í™”í ì‹œì¥ ì—°ë™ì„± ì²´í¬

        ğŸ”¬ NBIS (ë„¤ë¹„ìš°ìŠ¤ ê·¸ë£¹):
        â€¢ ë°”ì´ì˜¤ ì„¹í„° ê¸°ìˆ ì  ë¶„ì„

        ğŸš— TSLA (í…ŒìŠ¬ë¼):
        â€¢ ì£¼ìš” ì§€ì§€ì„ : $200, $180
        â€¢ ì €í•­ì„ : $250, $280
        â€¢ RSI/MACD ëª¨ë©˜í…€ í™•ì¸

        âš›ï¸ OKLO (ì˜¤í´ë¡œ):
        â€¢ ì—ë„ˆì§€ ì„¹í„° ê¸°ìˆ ì  íŒ¨í„´

        ğŸ’ MRVL (ë§ˆë²¨):
        â€¢ ë°˜ë„ì²´ ì„¹í„° ì§€ì§€/ì €í•­
        â€¢ AI ê´€ë ¨ì£¼ ëª¨ë©˜í…€

        ğŸ” PLTR (íŒ”ë€í‹°ì–´):
        â€¢ ì†Œí”„íŠ¸ì›¨ì–´ì£¼ ê¸°ìˆ ì  ë¶„ì„
        â€¢ ì •ë¶€ ê³„ì•½ ë‰´ìŠ¤ ì„íŒ©íŠ¸

        ğŸ“¡ AEVA (ì—ë°”):
        â€¢ ììœ¨ì£¼í–‰ ì„¹í„° ë³€ë™ì„± ì²´í¬

        ğŸ”— ìƒì„¸ ê¸°ìˆ ì  ë¶„ì„:
        ğŸ“Š TradingView: https://www.tradingview.com
        ğŸ“ˆ ì•¼í›„ íŒŒì´ë‚¸ìŠ¤: https://finance.yahoo.com

        ğŸ“… ${current_time}
        
        ğŸ’¡ ì°¸ê³ : ì‹¤ì œ íˆ¬ì ê²°ì •ì€ ê°œë³„ ì°¨íŠ¸ ë¶„ì„ í›„ ì‹ ì¤‘í•˜ê²Œ í•˜ì„¸ìš”."

        sleep 3

        # ì¶”ê°€ ì‹œì¥ ìš”ì•½
        curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.CHAT_ID }}" \
          -d "text=ğŸ“Š ì‹œì¥ ê¸°ìˆ ì  ë¶„ì„ ì²´í¬ë¦¬ìŠ¤íŠ¸

        âœ… ì˜¤ëŠ˜ í™•ì¸í•  ê¸°ìˆ ì  ì§€í‘œ:

        ğŸ“ˆ ì£¼ìš” ì§€ì§€/ì €í•­ì„ :
        â€¢ S&P 500: ì£¼ìš” ì´ë™í‰ê· ì„ 
        â€¢ NASDAQ: ê¸°ìˆ ì£¼ ëª¨ë©˜í…€
        â€¢ ê°œë³„ ì¢…ëª©: í”¼ë³´ë‚˜ì¹˜ ë˜ëŒë¦¼

        ğŸ“‰ ê³¼ë§¤ë„/ê³¼ë§¤ìˆ˜ í™•ì¸:
        â€¢ RSI (14ì¼): 30 ì´í•˜(ê³¼ë§¤ë„), 70 ì´ìƒ(ê³¼ë§¤ìˆ˜)
        â€¢ ìŠ¤í† ìºìŠ¤í‹±: %K, %D ë¼ì¸ êµì°¨ì 
        â€¢ MACD: ì‹œê·¸ë„ ë¼ì¸ ëŒíŒŒ ì—¬ë¶€

        ğŸ”„ ë³¼ë¥¨ ë¶„ì„:
        â€¢ ê±°ë˜ëŸ‰ ì¦ê°€ íŒ¨í„´
        â€¢ ê°€ê²© ìƒìŠ¹ ì‹œ ë³¼ë¥¨ í™•ì¸
        â€¢ ëŒíŒŒ êµ¬ê°„ ê±°ë˜ëŸ‰ ì²´í¬

        ğŸ’¡ ì˜¤ëŠ˜ì˜ í•µì‹¬:
        ê° ì¢…ëª©ë³„ ì°¨íŠ¸ë¥¼ ì§ì ‘ í™•ì¸í•˜ì—¬
        ê°œì¸ì ì¸ ì§„ì…/ì²­ì‚° ì‹œì ì„ 
        ê¸°ìˆ ì  ë¶„ì„ìœ¼ë¡œ íŒë‹¨í•˜ì„¸ìš”!

        ğŸ“… ${current_time}"
