name: í…”ë ˆê·¸ë¨ ìë™ ì•Œë¦¼

on:
  schedule:
    - cron: '0 22 * * *'  # ë§¤ì¼ í•œêµ­ì‹œê°„ 07ì‹œ
    - cron: '0 */4 * * *'  # 4ì‹œê°„ë§ˆë‹¤
  workflow_dispatch:

env:
  TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
  CHAT_ID: ${{ secrets.CHAT_ID }}

jobs:
  send-messages:
    runs-on: ubuntu-latest
    
    steps:
    - name: í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡
      run: |
        echo "ğŸ¤– í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡ ì‹œì‘"
        
        current_time=$(date '+%Y-%m-%d %H:%M KST')
        
        message="ğŸ¤– GitHub Actions ìë™í™” í…ŒìŠ¤íŠ¸

âœ… ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!

ğŸ“Š ì„¤ì •ëœ ê¸°ëŠ¥:
â€¢ ë§¤ì¼ 07ì‹œ ê³µí¬íƒìš•ì§€ìˆ˜ ì•Œë¦¼
â€¢ 4ì‹œê°„ë§ˆë‹¤ ì£¼ì‹ ì •ë³´
â€¢ ìë™ ìŠ¤ì¼€ì¤„ë§ ì‹¤í–‰

ğŸ• í˜„ì¬ ì‹œê°„: ${current_time}

ğŸš€ ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™!"
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=${message}"
        
        echo "âœ… í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ"
    
    - name: ê³µí¬íƒìš•ì§€ìˆ˜ ì „ì†¡
      run: |
        echo "ğŸ“Š ê³µí¬íƒìš•ì§€ìˆ˜ ê°€ì ¸ì˜¤ê¸°"
        
        response=$(curl -s "https://api.alternative.me/fng/")
        
        value=$(echo "$response" | grep -o '"value":"[^"]*' | head -1 | cut -d'"' -f4)
        classification=$(echo "$response" | grep -o '"value_classification":"[^"]*' | head -1 | cut -d'"' -f4)
        
        if [ -z "$value" ]; then
          value="50"
          classification="Neutral"
        fi
        
        if [ "$value" -le 24 ]; then
          emoji="ğŸ˜±"
        elif [ "$value" -le 49 ]; then
          emoji="ğŸ˜°"
        elif [ "$value" -le 74 ]; then
          emoji="ğŸ¤‘"
        else
          emoji="ğŸ¤¯"
        fi
        
        current_time=$(date '+%Y-%m-%d %H:%M KST')
        
        message="${emoji} ì˜¤ëŠ˜ì˜ ê³µí¬íƒìš•ì§€ìˆ˜

í˜„ì¬ ì§€ìˆ˜: ${value}/100
ìƒíƒœ: ${classification}

ğŸ’¡ ì§€ìˆ˜ í•´ì„:
0-24: ê·¹ë„ì˜ ê³µí¬ ğŸ˜±
25-49: ê³µí¬ ğŸ˜°
50-74: íƒìš• ğŸ¤‘
75-100: ê·¹ë„ì˜ íƒìš• ğŸ¤¯

ğŸ“… ${current_time}
ğŸ“Š ë°ì´í„°: Alternative.me"
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=${message}"
        
        echo "âœ… ê³µí¬íƒìš•ì§€ìˆ˜ ì „ì†¡ ì™„ë£Œ"
    
    - name: ì£¼ì‹ ì •ë³´ ì „ì†¡
      run: |
        echo "ğŸ“ˆ ì£¼ì‹ ì •ë³´ ì „ì†¡"
        
        current_time=$(date '+%Y-%m-%d %H:%M KST')
        
        # AAPL ì •ë³´
        message1="ğŸ“± AAPL (Apple) ì£¼ì‹ ì •ë³´

ğŸ’° ì‹¤ì‹œê°„ ì°¨íŠ¸ì™€ ì •ë³´ëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•˜ì„¸ìš”:

ğŸ“ˆ Yahoo Finance: https://finance.yahoo.com/quote/AAPL
ğŸ“Š TradingView: https://www.tradingview.com/symbols/AAPL
ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/AAPL/news

ğŸ“… ${current_time}"
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=${message1}"
        
        sleep 2
        
        # TSLA ì •ë³´
        message2="ğŸš— TSLA (Tesla) ì£¼ì‹ ì •ë³´

ğŸ’° ì‹¤ì‹œê°„ ì°¨íŠ¸ì™€ ì •ë³´ëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•˜ì„¸ìš”:

ğŸ“ˆ Yahoo Finance: https://finance.yahoo.com/quote/TSLA
ğŸ“Š TradingView: https://www.tradingview.com/symbols/TSLA
ğŸ“° ë‰´ìŠ¤: https://finance.yahoo.com/quote/TSLA/news

ğŸ“… ${current_time}"
        
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
          -d "chat_id=${CHAT_ID}" \
          -d "text=${message2}"
        
        echo "âœ… ì£¼ì‹ ì •ë³´ ì „ì†¡ ì™„ë£Œ"
